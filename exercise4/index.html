<html>
<head>

    <title>CG1 Exercise 04 - Texturing</title>

    <!-- import main JavaScript module using RequireJS -->
    <script src="js/libs/three.min.js"></script>
    <script src="js/libs/stats.min.js"></script>
    <script src="js/libs/dat.gui.min.js"></script>
    <script src="js/controls/TrackballControls.js"></script>
    <script src="js/controls/OrbitControls.js"></script>

    <script src="js/scenecontroller.js"></script>
    <script src="js/htmlcontroller.js"></script>
    <script src="js/main.js"></script>

    <!-- import style sheet -->
    <link rel="stylesheet" type="text/css" media="screen" href="style.css">

</head>

<script id="vertexShader" type="x-shader/x-vertex">
    varying vec2 vUv;

    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
    }
</script>

<script id="fragmentShader" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        gl_FragColor = texture2D(texture, vUv);
    }
</script>

<script id="sphericalVertexShader" type="x-shader/x-vertex">
    varying vec4 texCoords;

    void main() {
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        texCoords = vec4(position, 1.0);
    }
</script>

<script id="sphericalFragmentShader" type="x-shader/x-fragment">
	uniform vec3 sphereCenter;
    uniform sampler2D texture;
    varying vec4 texCoords;

    void main() {
        const float PI = 3.1415926;
        float X = sphereCenter.x - texCoords.x;
        float Y = sphereCenter.y - texCoords.y;
        float Z = sphereCenter.z - texCoords.z;
        float atanYX = atan(Y, X);
        atanYX = clamp(atanYX, -1.0, 1.0);

        float powX = pow(X, 2.0);
        float powY = pow(Y, 2.0);
        float atanXZ = atan(sqrt(powX + powY), Z);

        vec2 uV = vec2(atanYX + PI / (PI * 2.0), atanXZ / PI);
        gl_FragColor = texture2D(texture, uV);
    }
</script>

<body onLoad="main()">
    <!-- this element will be used to diplay errors -->
    <pre id="error"></pre>

</body>
</html>
